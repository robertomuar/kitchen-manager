import{j as v,u as P,y as w,c as $,w as S,a as d,b as t,d as a,h as A,t as r,l as G,f as k,e as R,g as f,i as C,k as u,q as x,o as p,F as T,m as L,z as D}from"./app-DgjmkXFC.js";import{_ as H}from"./AuthenticatedLayout-DwczY6YG.js";import{_ as c}from"./InputError-leB_bNdK.js";import"./ApplicationLogo-D-eAWrVV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"py-10"},K={class:"mx-auto max-w-5xl px-4 sm:px-6 lg:px-8 space-y-6"},Q={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},W={class:"text-2xl font-semibold text-slate-50"},X={class:"mx-auto max-w-4xl rounded-2xl border border-slate-200 bg-white/95 p-6 shadow-xl shadow-slate-900/20 text-slate-900"},Y={class:"space-y-1"},Z={class:"flex gap-2"},ee=["disabled"],te={key:0,class:"mt-1 text-xs text-emerald-600"},se={key:1,class:"mt-1 text-xs text-rose-600"},oe={class:"space-y-1"},ae={class:"grid gap-6 md:grid-cols-2"},le={class:"space-y-1"},de={class:"space-y-1"},ie=["value"],ne={class:"grid gap-6 md:grid-cols-2"},re={class:"space-y-1"},ue={class:"space-y-1"},ce=["value"],me={class:"space-y-1"},pe={class:"pt-4 flex justify-end"},fe=["disabled"],ve={__name:"Form",props:{product:{type:Object,default:null},locations:{type:Array,default:()=>[]},mode:{type:String,default:"create"}},setup(h){var V,N,U,j,z,E,B;const l=h,F=["unidad","ud","L","ml","kg","g","pack","caja","bolsa","bote"],_=v(()=>{var n;return l.mode==="edit"||!!((n=l.product)!=null&&n.id)}),s=P({barcode:((V=l.product)==null?void 0:V.barcode)??"",name:((N=l.product)==null?void 0:N.name)??"",default_quantity:((U=l.product)==null?void 0:U.default_quantity)??"",default_unit:((j=l.product)==null?void 0:j.default_unit)??"",default_pack_size:((z=l.product)==null?void 0:z.default_pack_size)??"",location_id:((E=l.product)==null?void 0:E.location_id)??"",notes:((B=l.product)==null?void 0:B.notes)??""}),q=v(()=>_.value?"Editar producto":"Nuevo producto"),I=v(()=>_.value?"Guardar cambios":"Crear producto"),M=()=>{_.value?s.put(route("products.update",l.product.id)):s.post(route("products.store"))},b=w(!1),g=w(""),i=w(""),O=async()=>{var n,e;if(g.value="",i.value="",!s.barcode){i.value="Introduce primero un código de barras.";return}try{b.value=!0;const y=(await window.axios.get(route("products.barcode.lookup"),{params:{barcode:s.barcode}})).data;if(!y.found){i.value=y.message||"No se encontró información para este código.";return}const m=y.suggested??{};!s.name&&m.name&&(s.name=m.name),!s.default_quantity&&m.default_quantity&&(s.default_quantity=m.default_quantity),!s.default_unit&&m.default_unit&&(s.default_unit=m.default_unit),g.value="Datos sugeridos aplicados. Revisa antes de guardar."}catch(o){(e=(n=o.response)==null?void 0:n.data)!=null&&e.message?i.value=o.response.data.message:i.value="No se pudo consultar la información. Inténtalo de nuevo."}finally{b.value=!1}};return(n,e)=>(p(),$(H,null,{default:S(()=>[d(a(A),{title:q.value},null,8,["title"]),t("div",J,[t("div",K,[t("div",Q,[t("div",null,[t("h1",W,r(q.value),1),e[7]||(e[7]=t("p",{class:"mt-1 text-sm text-slate-400"}," Define un producto que utilizas en tu cocina: código de barras, nombre, cantidad base, unidad y ubicación habitual. ",-1))]),d(a(G),{href:n.route("products.index"),class:"text-sm text-slate-300 hover:text-slate-100"},{default:S(()=>[...e[8]||(e[8]=[k(" Volver al listado ",-1)])]),_:1},8,["href"])]),t("div",X,[t("form",{class:"space-y-6",onSubmit:R(M,["prevent"])},[t("div",Y,[e[9]||(e[9]=t("label",{for:"barcode",class:"block text-sm font-medium text-slate-800"},[k(" Código de barras "),t("span",{class:"text-xs text-slate-500"}," (opcional, pero recomendado) ")],-1)),t("div",Z,[u(t("input",{id:"barcode","onUpdate:modelValue":e[0]||(e[0]=o=>a(s).barcode=o),type:"text",class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none",placeholder:"Ej: 8412345678901"},null,512),[[x,a(s).barcode]]),t("button",{type:"button",onClick:O,disabled:b.value,class:"inline-flex items-center rounded-xl bg-indigo-500 px-4 py-2 text-xs font-semibold text-white shadow-sm shadow-indigo-500/40 hover:bg-indigo-600 disabled:opacity-60 disabled:cursor-wait"},r(b.value?"Buscando...":"Buscar datos online"),9,ee)]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.barcode},null,8,["message"]),g.value?(p(),f("p",te,r(g.value),1)):C("",!0),i.value?(p(),f("p",se,r(i.value),1)):C("",!0)]),t("div",oe,[e[10]||(e[10]=t("label",{for:"name",class:"block text-sm font-medium text-slate-800"}," Nombre * ",-1)),u(t("input",{id:"name","onUpdate:modelValue":e[1]||(e[1]=o=>a(s).name=o),type:"text",required:"",class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none",placeholder:"Leche entera, Pasta, Tomate frito..."},null,512),[[x,a(s).name]]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.name},null,8,["message"])]),t("div",ae,[t("div",le,[e[11]||(e[11]=t("label",{for:"default_quantity",class:"block text-sm font-medium text-slate-800"}," Cantidad base ",-1)),u(t("input",{id:"default_quantity","onUpdate:modelValue":e[2]||(e[2]=o=>a(s).default_quantity=o),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 shadow-sm focus;border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none",placeholder:"1, 0.5, 3..."},null,512),[[x,a(s).default_quantity]]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.default_quantity},null,8,["message"])]),t("div",de,[e[13]||(e[13]=t("label",{for:"default_unit",class:"block text-sm font-medium text-slate-800"}," Unidad ",-1)),u(t("select",{id:"default_unit","onUpdate:modelValue":e[3]||(e[3]=o=>a(s).default_unit=o),class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none"},[e[12]||(e[12]=t("option",{value:""}," Selecciona una unidad ",-1)),(p(),f(T,null,L(F,o=>t("option",{key:o,value:o},r(o),9,ie)),64))],512),[[D,a(s).default_unit]]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.default_unit},null,8,["message"])])]),t("div",ne,[t("div",re,[e[14]||(e[14]=t("label",{for:"default_pack_size",class:"block text-sm font-medium text-slate-800"},[k(" Tamaño de pack "),t("span",{class:"text-xs text-slate-500"}," (opcional) ")],-1)),u(t("input",{id:"default_pack_size","onUpdate:modelValue":e[4]||(e[4]=o=>a(s).default_pack_size=o),type:"text",class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none",placeholder:"Ej: 6 (pack de 6)"},null,512),[[x,a(s).default_pack_size]]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.default_pack_size},null,8,["message"])]),t("div",ue,[e[16]||(e[16]=t("label",{for:"location_id",class:"block text-sm font-medium text-slate-800"}," Ubicación habitual ",-1)),u(t("select",{id:"location_id","onUpdate:modelValue":e[5]||(e[5]=o=>a(s).location_id=o),class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none"},[e[15]||(e[15]=t("option",{value:""}," Sin ubicación asignada ",-1)),(p(!0),f(T,null,L(h.locations,o=>(p(),f("option",{key:o.id,value:o.id},r(o.name),9,ce))),128))],512),[[D,a(s).location_id]]),e[17]||(e[17]=t("p",{class:"mt-1 text-xs text-slate-500"}," Estas ubicaciones se gestionan en la sección “Ubicaciones”. ",-1)),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.location_id},null,8,["message"])])]),t("div",me,[e[18]||(e[18]=t("label",{for:"notes",class:"block text-sm font-medium text-slate-800"}," Notas (opcional) ",-1)),u(t("textarea",{id:"notes","onUpdate:modelValue":e[6]||(e[6]=o=>a(s).notes=o),rows:"3",class:"block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/40 focus:outline-none",placeholder:"Ej: marca preferida, usar primero los paquetes abiertos..."},null,512),[[x,a(s).notes]]),d(c,{class:"mt-1 text-xs text-rose-600",message:a(s).errors.notes},null,8,["message"])]),t("div",pe,[t("button",{type:"submit",disabled:a(s).processing,class:"inline-flex items-center justify-center rounded-xl bg-indigo-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm shadow-indigo-500/40 hover:bg-indigo-600 disabled:opacity-60 disabled:cursor-wait"},r(I.value),9,fe)])],32)])])])]),_:1}))}};export{ve as default};
